seajs.use(["bootstrap","$","widget","underscore","validator"],function(a,b,c,d,e){"use strict";function f(a){var f=d.template(b("#j-modal-tmpl").html());b("body").append(f({domId:a.domId,title:a.title,content:a.content,cancelText:a.cancelText,confirmId:a.confirmId,confirmText:a.confirmText})),c.autoRenderAll();var g=b("#"+a.domId);g.find(".modal-lg").removeClass("modal-lg"),g.modal("show"),g.on("hidden.bs.modal",function(){g.remove()}),e.query("#"+a.domId+" form").on("formValidated",function(c,d,e){if(console.log(c,d,e),!c){var f=e.serializeArray();console.log(f),g.modal("hide"),a.callback(f),b.ajax({url:"",type:"POST",data:e.serializeArray(),dataType:"json",success:function(){},error:function(){}})}})}function g(a,c,e){var g="<div id='icon_"+e.tId+"' class='linkfour hidden'><a class='j-action-icon delete' href='javascript:;'></a> <a class='j-action-icon edit' href='javascript:;'></a> <a class='yu' href='javascript:;'></a> <a class='tou' href='javascript:;'></a></div>",h=b("#"+e.tId+" a");h.append(g).hover(function(){b("#icon_"+e.tId).removeClass("hidden")},function(){b("#icon_"+e.tId).addClass("hidden")}),b("#icon_"+e.tId).on("click",".j-action-icon",function(a){var c=b(a.target);if(c.hasClass("delete"))confirm("是否删除？")&&b.fn.zTree.getZTreeObj("tree").removeNode(e);else{var g=d.template(b("#j-edit-form").html()),h=b("#"+e.tId+"_span");f({domId:"j-edit-modal",title:"新建网站",content:g({siteName:h.text()}),cancelText:"取消",confirmId:"j-confirm",confirmText:"修改",callback:function(a){h.html(a[0].value)}})}})}b(".help-popover").popover();var h=[{id:1,pId:0,name:"父节点 1",open:!1},{id:11,pId:1,name:"叶子节点 1-1"},{id:12,pId:1,name:"叶子节点 1-2"},{id:13,pId:1,name:"叶子节点 1-3"},{id:77,pId:0,name:"无子类",open:!1},{id:2,pId:0,name:"父节点 2",open:!1},{id:21,pId:2,name:"叶子节点 2-1"},{id:22,pId:2,name:"叶子节点 2-2"},{id:23,pId:2,name:"叶子节点 2-3"},{id:3,pId:0,name:"父节点 3",open:!1},{id:31,pId:3,name:"叶子节点 3-1"},{id:32,pId:3,name:"叶子节点 3-2"},{id:33,pId:3,name:"叶子节点 3-3"}],i={view:{showIcon:!1,showLine:!1},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId",rootPId:""}},callback:{onNodeCreated:g,onClick:this.onClick}};b(document).ready(function(){b.fn.zTree.init(b("#tree"),i,h),b("#checkAll").on("click",function(){b(this).prop("checked")?b("input[name=cId]").prop("checked",!0):b("input[name=cId]").prop("checked",!1)})}),b("#j-add").click(function(){f({domId:"j-add-modal",title:"新建网站",content:b("#j-add-form").html(),cancelText:"取消",confirmId:"j-confirm",confirmText:"提交",callback:function(a){var c=b.fn.zTree.getZTreeObj("tree"),d={name:a[0].value};c.addNodes(null,d)}})}),b(document).on("click","#j-confirm",function(){b(".modal .form-horizontal").trigger("submit")})});