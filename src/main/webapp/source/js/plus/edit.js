seajs.use(["$","widget","underscore","bootstrap","validator"],function(a,b,c,d,e){b.autoRenderAll(),window.showEditModal=function(){var d=a("#j-editmodal-tmpl").html(),f=(new Date).getTime(),g="j-dom"+f,h="j-formId"+f,i="j-confirm"+f,j={domId:g,formId:h,title:"编辑",cancelText:"取消",confirmText:"确定",confirmId:i};a("body").append(c.template(d,j));var k=a("#"+g);b.autoRenderAll(),k.find(".j-sel2").select2({formatNoMatches:"没有找到相关信息",formatSearching:"正在加载数据",formatLoadMore:"正在加载更多数据",formatAjaxError:"加载数据失败",minimumInputLength:1,ajax:{url:"https://api.github.com/search/repositories",dataType:"json",quietMillis:250,data:function(b,c){return b=a.trim(b),b=""===b?"default":b,{type:a(this).data("type"),q:b,page:c}},results:function(a,b){var c=10*b<a.total_count;return{results:a.items,more:c}},cache:!0},formatResult:function(a){return a.full_name},formatSelection:function(a){return a.full_name}}).on("select2-open",function(){a(this).select2("search"," ")}),e.query("#"+h).on("formValidated",function(b,c,d){console.log(b,c,d),b||(console.log(d.serializeArray()),k.modal("hide"),a.ajax({url:"",type:"POST",data:d.serializeArray(),dataType:"json",success:function(){},error:function(){}}))}),k.modal("show").on("hidden.bs.modal",function(){k.remove()})},window.showTreeModal=function(b){var d=b.domId,e=a("#"+d);if(e.size()>0)e.modal("show");else{var f=a("#j-tree-tmpl").html(),g=(new Date).getTime(),h="j-confirm"+g,i={domId:d,title:"地域定向",cancelText:"取消",confirmText:"确定",confirmId:h,treeId1:"j-tree1-"+g,treeId2:"j-tree2-"+g};a("body").append(c.template(f,i));var e=a("#"+d);e.modal("show");var j={check:{enable:!1},data:{simpleData:{enable:!0}},view:{dblClickExpand:!1,showIcon:!1,showLine:!1}},k=a.fn.zTree.init(a("#"+i.treeId2),j),l={check:{enable:!0},data:{simpleData:{enable:!0}},callback:{onCheck:function(){var b=function(a){return 0==a.level&&a.checked},c=m.getNodesByFilter(b);k=a.fn.zTree.init(a("#"+i.treeId2),j,c);for(var d=k.getCheckedNodes(!1),e=0,f=d.length;f>e;e++)k.removeNode(d[e])}},view:{showIcon:!1,showLine:!1}},m=a.fn.zTree.init(a("#"+i.treeId1),l);a.ajax({url:"znodes.json",type:"GET",dataType:"json",success:function(a){var b=a.nodes;m.addNodes(null,b)},error:function(){}}),e.find("#"+h).unbind().click(function(){var b=[],c=[],d=function(a){for(var e=0,f=a.length;f>e;e++){var g=a[e].getCheckStatus();g.checked&&(g.half?d(a[e].children):(b[b.length]=a[e].name,c[c.length]=a[e].value))}},f=function(a){return 0==a.level&&a.checked},g=m.getNodesByFilter(f);d(g),a("#j-area-tree").html(a("#j-dx").val()+" name: "+b.join(",")+"      value: "+c.join(",")),e.modal("hide")})}}});